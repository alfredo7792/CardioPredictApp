// // import React, { useState, useEffect } from 'react';
// // import { View, Text, StyleSheet, FlatList, TouchableOpacity, Image, TextInput } from 'react-native';
// // import { StatusBar } from "expo-status-bar";
// // import AsyncStorage from '@react-native-async-storage/async-storage';
// // import Response from "@/components/response";
// // import Message from "@/components/message";

// // const STORAGE_KEY = '@chat_history';

// // const chatbot = () => {
// //     const [inputText, setInputText] = useState("");
// //     const [listData, setListData] = useState<string[]>([]);

// //     useEffect(() => {
// //         loadChatHistory();
// //     }, []);

// //     const loadChatHistory = async () => {
// //         try {
// //             const storedData = await AsyncStorage.getItem(STORAGE_KEY);
// //             if (storedData !== null) {
// //                 setListData(JSON.parse(storedData));
// //             }
// //         } catch (error) {
// //             console.error('Error loading chat history:', error);
// //         }
// //     };

// //     const saveChatHistory = async (newList: string[]) => {
// //         try {
// //             await AsyncStorage.setItem(STORAGE_KEY, JSON.stringify(newList));
// //         } catch (error) {
// //             console.error('Error saving chat history:', error);
// //         }
// //     };

// //     const handleSearchInput = () => {
// //         if (inputText.trim()) {
// //             const newList = [...listData, inputText];
// //             setListData(newList);
// //             saveChatHistory(newList);
// //             setInputText("");
// //         }
// //     };

// //     return (
// //         <View style={styles.container}>
// //             <StatusBar style="auto" />

// //             {/* Header */}
// //             <View style={styles.header}>
// //                 <Image source={require("../../assets/icons/robot.png")} style={styles.icon} />
// //                 <Text style={styles.headerText}>Gemini AI</Text>
// //             </View>

// //             {/* Content */}
// //             <FlatList
// //                 style={styles.flatList}
// //                 data={listData}
// //                 renderItem={({ item }) => (
// //                     <View>
// //                         <Message message={item} />
// //                         <Response prompt={item} />
// //                     </View>
// //                 )}
// //                 keyExtractor={(item, index) => index.toString()}
// //             />

// //             {/* Search-Bar */}
// //             <View style={styles.searchBar}>
// //                 <TextInput 
// //                     placeholder="Ask to Gemini AI" 
// //                     style={styles.input} 
// //                     value={inputText} 
// //                     onChangeText={setInputText} 
// //                     selectionColor={"#323232"}
// //                 />
// //                 <TouchableOpacity onPress={handleSearchInput}>
// //                     <Image source={require("../../assets/icons/right-arrow.png")} style={styles.icon} />
// //                 </TouchableOpacity>
// //             </View>
// //         </View>
// //     );
// // };

// // const styles = StyleSheet.create({
// //     container: {
// //         flex: 1,
// //         backgroundColor: '#fff',
// //         paddingTop: 36,
// //     },
// //     header: {
// //         flexDirection: "row",
// //         alignItems: "center",
// //         paddingHorizontal: 16,
// //         margin: 8,
// //         gap: 8,
// //     },
// //     icon: {
// //         width: 32,
// //         height: 32,
// //     },
// //     headerText: {
// //         fontSize: 24,
// //         fontWeight: "800",
// //         color: "#323232",
// //     },
// //     flatList: {
// //         paddingHorizontal: 16,
// //         marginBottom: 80,
// //     },
// //     searchBar: {
// //         backgroundColor: "#ffffff",
// //         width: "100%",
// //         position: "absolute",
// //         bottom: 0,
// //         flexDirection: "row",
// //         justifyContent: "center",
// //         alignItems: "center",
// //         paddingHorizontal: 32,
// //         paddingVertical: 16,
// //         gap: 8,
// //     },
// //     input: {
// //         backgroundColor: "#fff",
// //         width: "85%",
// //         fontSize: 16,
// //         paddingVertical: 16,
// //         paddingHorizontal: 24,
// //         borderRadius: 32,
// //         borderWidth: 0.1,
// //     },
// // });

// // export default chatbot;


// // import React, { useState } from 'react';
// // import { View, Text, StyleSheet, FlatList, TouchableOpacity, Image, TextInput } from 'react-native';
// // import { StatusBar } from "expo-status-bar";
// // import Response from "@/components/response";
// // import Message from "@/components/message";

// // const chatbot = () => {
// //     const [inputText, setInputText] = useState<string>(""); // Especificar tipo string
// //     const [listData, setListData] = useState<string[]>([]); // Especificar tipo string[]

// //     const handleSearchInput = () => {
// //         if (inputText.trim()) {  // Asegurarse de que no se agreguen cadenas vacÃ­as
// //             setListData((prevList) => [...prevList, inputText]);
// //             setInputText("");
// //         }
// //     };

// //     return (
// //         <View style={styles.container}>
// //             <StatusBar style="auto" />

// //             {/* Header */}
// //             <View style={styles.header}>
// //                 <Image source={require("../../assets/icons/robot.png")} style={styles.icon} />

// //                 <Text style={styles.headerText}>Gemini AI</Text>
// //             </View>

// //             {/* Content */}
// //             <FlatList
// //                 style={styles.flatList}
// //                 data={listData}
// //                 renderItem={({ item }) => (
// //                     <View>
// //                         <Message message={item} />
// //                         <Response prompt={item} />
// //                     </View>
// //                 )}
// //                 keyExtractor={(item, index) => index.toString()}
// //             />

// //             {/* Search-Bar */}
// //             <View style={styles.searchBar}>
// //                 <TextInput 
// //                     placeholder="Ask to Gemini AI" 
// //                     style={styles.input} 
// //                     value={inputText} 
// //                     onChangeText={setInputText} 
// //                     selectionColor={"#323232"}
// //                 />
// //                 <TouchableOpacity onPress={handleSearchInput}>
// //                     <Image source={require("../../assets/icons/right-arrow.png")} style={styles.icon} />
// //                 </TouchableOpacity>
// //             </View>
// //         </View>
// //     );
// // };

// // const styles = StyleSheet.create({
// //     container: {
// //         flex: 1,
// //         backgroundColor: '#fff',
// //         paddingTop: 36,
// //     },
// //     header: {
// //         flexDirection: "row",
// //         alignItems: "center",
// //         paddingHorizontal: 16,
// //         margin: 8,
// //         gap: 8,
// //     },
// //     icon: {
// //         width: 32,
// //         height: 32,
// //     },
// //     headerText: {
// //         fontSize: 24,
// //         fontWeight: "800",
// //         color: "#323232",
// //     },
// //     flatList: {
// //         paddingHorizontal: 16,
// //         marginBottom: 80,
// //     },
// //     searchBar: {
// //         backgroundColor: "#ffffff",
// //         width: "100%",
// //         position: "absolute",
// //         bottom: 0,
// //         flexDirection: "row",
// //         justifyContent: "center",
// //         alignItems: "center",
// //         paddingHorizontal: 32,
// //         paddingVertical: 16,
// //         gap: 8,
// //     },
// //     input: {
// //         backgroundColor: "#fff",
// //         width: "85%",
// //         fontSize: 16,
// //         paddingVertical: 16,
// //         paddingHorizontal: 24,
// //         borderRadius: 32,
// //         borderWidth: 0.1,
// //     },
// // });

// // export default chatbot;


// // import React, { useState, useEffect } from 'react';
// // import { View, Text, StyleSheet, FlatList, TouchableOpacity, Image, TextInput, Alert } from 'react-native';
// // import { StatusBar } from "expo-status-bar";
// // import AsyncStorage from '@react-native-async-storage/async-storage';
// // import Response from "@/components/response";
// // import Message from "@/components/message";

// // const STORAGE_KEY = '@chat_history';

// // interface Chat {
// //   id: string;
// //   messages: string[];
// // }

// // const Chatbot = () => {
// //   const [inputText, setInputText] = useState("");
// //   const [chats, setChats] = useState<Chat[]>([]);
// //   const [currentChatId, setCurrentChatId] = useState<string | null>(null);

// //   useEffect(() => {
// //     loadChats();
// //   }, []);

// //   const loadChats = async () => {
// //     try {
// //       const storedData = await AsyncStorage.getItem(STORAGE_KEY);
// //       if (storedData !== null) {
// //         const loadedChats = JSON.parse(storedData);
// //         setChats(loadedChats);
// //         if (loadedChats.length > 0) {
// //           setCurrentChatId(loadedChats[0].id);
// //         }
// //       }
// //     } catch (error) {
// //       console.error('Error loading chats:', error);
// //     }
// //   };

// //   const saveChats = async (newChats: Chat[]) => {
// //     try {
// //       await AsyncStorage.setItem(STORAGE_KEY, JSON.stringify(newChats));
// //     } catch (error) {
// //       console.error('Error saving chats:', error);
// //     }
// //   };

// //   const handleSearchInput = () => {
// //     if (inputText.trim() && currentChatId) {
// //       const updatedChats = chats.map(chat => 
// //         chat.id === currentChatId 
// //           ? { ...chat, messages: [...chat.messages, inputText] }
// //           : chat
// //       );
// //       setChats(updatedChats);
// //       saveChats(updatedChats);
// //       setInputText("");
// //     }
// //   };

// //   const createNewChat = () => {
// //     const newChat: Chat = {
// //       id: Date.now().toString(),
// //       messages: []
// //     };
// //     const updatedChats = [newChat, ...chats];
// //     setChats(updatedChats);
// //     setCurrentChatId(newChat.id);
// //     saveChats(updatedChats);
// //   };

// //   const deleteChat = (chatId: string) => {
// //     Alert.alert(
// //       "Delete Chat",
// //       "Are you sure you want to delete this chat?",
// //       [
// //         { text: "Cancel", style: "cancel" },
// //         { 
// //           text: "OK", 
// //           onPress: () => {
// //             const updatedChats = chats.filter(chat => chat.id !== chatId);
// //             setChats(updatedChats);
// //             if (currentChatId === chatId) {
// //               setCurrentChatId(updatedChats.length > 0 ? updatedChats[0].id : null);
// //             }
// //             saveChats(updatedChats);
// //           }
// //         }
// //       ]
// //     );
// //   };

// //   const currentChat = chats.find(chat => chat.id === currentChatId);

// //   return (
// //     <View style={styles.container}>
// //       <StatusBar style="auto" />

// //       {/* Header */}
// //       <View style={styles.header}>
// //         <Image source={require("../../assets/icons/robot.png")} style={styles.icon} />
// //         <Text style={styles.headerText}>Gemini AI</Text>
// //         <TouchableOpacity onPress={createNewChat} style={styles.newChatButton}>
// //           <Text style={styles.newChatButtonText}>New Chat</Text>
// //         </TouchableOpacity>
// //       </View>

// //       {/* Chat List */}
// //       <FlatList
// //         horizontal
// //         data={chats}
// //         renderItem={({ item }) => (
// //           <TouchableOpacity 
// //             style={[styles.chatItem, currentChatId === item.id && styles.selectedChatItem]}
// //             onPress={() => setCurrentChatId(item.id)}
// //             onLongPress={() => deleteChat(item.id)}
// //           >
// //             <Text style={styles.chatItemText}>Chat {item.id.slice(0, 4)}</Text>
// //           </TouchableOpacity>
// //         )}
// //         keyExtractor={item => item.id}
// //         style={styles.chatList}
// //       />

// //       {/* Content */}
// //       <FlatList
// //         style={styles.flatList}
// //         data={currentChat?.messages || []}
// //         renderItem={({ item }) => (
// //           <View>
// //             <Message message={item} />
// //             <Response prompt={item} />
// //           </View>
// //         )}
// //         keyExtractor={(item, index) => index.toString()}
// //       />

// //       {/* Search-Bar */}
// //       <View style={styles.searchBar}>
// //         <TextInput 
// //           placeholder="Ask to Gemini AI" 
// //           style={styles.input} 
// //           value={inputText} 
// //           onChangeText={setInputText} 
// //           selectionColor={"#323232"}
// //         />
// //         <TouchableOpacity onPress={handleSearchInput}>
// //           <Image source={require("../../assets/icons/right-arrow.png")} style={styles.icon} />
// //         </TouchableOpacity>
// //       </View>
// //     </View>
// //   );
// // };

// // const styles = StyleSheet.create({
// //   container: {
// //     flex: 1,
// //     backgroundColor: '#fff',
// //     paddingTop: 36,
// //   },
// //   header: {
// //     flexDirection: "row",
// //     alignItems: "center",
// //     justifyContent: "space-between",
// //     paddingHorizontal: 16,
// //     margin: 8,
// //   },
// //   icon: {
// //     width: 32,
// //     height: 32,
// //   },
// //   headerText: {
// //     fontSize: 24,
// //     fontWeight: "800",
// //     color: "#323232",
// //   },
// //   newChatButton: {
// //     backgroundColor: "#007AFF",
// //     padding: 8,
// //     borderRadius: 8,
// //   },
// //   newChatButtonText: {
// //     color: "#FFFFFF",
// //     fontWeight: "600",
// //   },
// //   chatList: {
// //     maxHeight: 50,
// //   },
// //   chatItem: {
// //     padding: 8,
// //     marginRight: 8,
// //     backgroundColor: "#E0E0E0",
// //     borderRadius: 8,
// //   },
// //   selectedChatItem: {
// //     backgroundColor: "#B0B0B0",
// //   },
// //   chatItemText: {
// //     fontWeight: "600",
// //   },
// //   flatList: {
// //     paddingHorizontal: 16,
// //     marginBottom: 80,
// //   },
// //   searchBar: {
// //     backgroundColor: "#ffffff",
// //     width: "100%",
// //     position: "absolute",
// //     bottom: 0,
// //     flexDirection: "row",
// //     justifyContent: "center",
// //     alignItems: "center",
// //     paddingHorizontal: 32,
// //     paddingVertical: 16,
// //     gap: 8,
// //   },
// //   input: {
// //     backgroundColor: "#fff",
// //     width: "85%",
// //     fontSize: 16,
// //     paddingVertical: 16,
// //     paddingHorizontal: 24,
// //     borderRadius: 32,
// //     borderWidth: 0.1,
// //   },
// // });

// // export default Chatbot;


// import React, { useState, useEffect } from 'react';
// import { View, Text, StyleSheet, FlatList, TouchableOpacity, Image, TextInput, Alert } from 'react-native';
// import { StatusBar } from "expo-status-bar";
// import AsyncStorage from '@react-native-async-storage/async-storage';
// import Response from "@/components/response";
// import Message from "@/components/message";

// const STORAGE_KEY = '@chat_history';

// interface Chat {
//   id: string;
//   messages: string[];
// }

// const Chatbot = () => {
//   const [inputText, setInputText] = useState("");
//   const [chats, setChats] = useState<Chat[]>([]);
//   const [currentChatId, setCurrentChatId] = useState<string | null>(null);

//   useEffect(() => {
//     loadChats();
//   }, []);

//   const loadChats = async () => {
//     try {
//       const storedData = await AsyncStorage.getItem(STORAGE_KEY);
//       if (storedData !== null) {
//         const loadedChats = JSON.parse(storedData);
//         // Filter out any chats without an id
//         const validChats = loadedChats.filter((chat: Chat) => chat && chat.id);
//         setChats(validChats);
//         if (validChats.length > 0) {
//           setCurrentChatId(validChats[0].id);
//         }
//       }
//     } catch (error) {
//       console.error('Error loading chats:', error);
//     }
//   };

//   const saveChats = async (newChats: Chat[]) => {
//     try {
//       await AsyncStorage.setItem(STORAGE_KEY, JSON.stringify(newChats));
//     } catch (error) {
//       console.error('Error saving chats:', error);
//     }
//   };

//   const handleSearchInput = () => {
//     if (inputText.trim() && currentChatId) {
//       const updatedChats = chats.map(chat => 
//         chat.id === currentChatId 
//           ? { ...chat, messages: [...chat.messages, inputText] }
//           : chat
//       );
//       setChats(updatedChats);
//       saveChats(updatedChats);
//       setInputText("");
//     }
//   };

//   const createNewChat = () => {
//     const newChat: Chat = {
//       id: Date.now().toString(),
//       messages: []
//     };
//     const updatedChats = [newChat, ...chats];
//     setChats(updatedChats);
//     setCurrentChatId(newChat.id);
//     saveChats(updatedChats);
//   };

//   const deleteChat = (chatId: string) => {
//     Alert.alert(
//       "Delete Chat",
//       "Are you sure you want to delete this chat?",
//       [
//         { text: "Cancel", style: "cancel" },
//         { 
//           text: "OK", 
//           onPress: () => {
//             const updatedChats = chats.filter(chat => chat.id !== chatId);
//             setChats(updatedChats);
//             if (currentChatId === chatId) {
//               setCurrentChatId(updatedChats.length > 0 ? updatedChats[0].id : null);
//             }
//             saveChats(updatedChats);
//           }
//         }
//       ]
//     );
//   };

//   const currentChat = chats.find(chat => chat.id === currentChatId);

//   return (
//     <View style={styles.container}>
//       <StatusBar style="auto" />

//       {/* Header */}
//       <View style={styles.header}>
//         <Image source={require("../../assets/icons/robot.png")} style={styles.icon} />
//         <Text style={styles.headerText}>Gemini AI</Text>
//         <TouchableOpacity onPress={createNewChat} style={styles.newChatButton}>
//           <Text style={styles.newChatButtonText}>New Chat</Text>
//         </TouchableOpacity>
//       </View>

//       {/* Chat List */}
//       <FlatList
//         horizontal
//         data={chats}
//         renderItem={({ item }) => (
//           <TouchableOpacity 
//             style={[styles.chatItem, currentChatId === item.id && styles.selectedChatItem]}
//             onPress={() => setCurrentChatId(item.id)}
//             onLongPress={() => deleteChat(item.id)}
//           >
//             <Text style={styles.chatItemText}>
//               {item && item.id ? `Chat ${item.id.slice(0, 4)}` : 'Invalid Chat'}
//             </Text>
//           </TouchableOpacity>
//         )}
//         keyExtractor={item => item.id || Math.random().toString()}
//         style={styles.chatList}
//       />

//       {/* Content */}
//       <FlatList
//         style={styles.flatList}
//         data={currentChat?.messages || []}
//         renderItem={({ item }) => (
//           <View>
//             <Message message={item} />
//             <Response prompt={item} />
//           </View>
//         )}
//         keyExtractor={(item, index) => index.toString()}
//       />

//       {/* Search-Bar */}
//       <View style={styles.searchBar}>
//         <TextInput 
//           placeholder="Ask to Gemini AI" 
//           style={styles.input} 
//           value={inputText} 
//           onChangeText={setInputText} 
//           selectionColor={"#323232"}
//         />
//         <TouchableOpacity onPress={handleSearchInput}>
//           <Image source={require("../../assets/icons/right-arrow.png")} style={styles.icon} />
//         </TouchableOpacity>
//       </View>
//     </View>
//   );
// };

// const styles = StyleSheet.create({
//   container: {
//     flex: 1,
//     backgroundColor: '#fff',
//     paddingTop: 36,
//   },
//   header: {
//     flexDirection: "row",
//     alignItems: "center",
//     justifyContent: "space-between",
//     paddingHorizontal: 16,
//     margin: 8,
//   },
//   icon: {
//     width: 32,
//     height: 32,
//   },
//   headerText: {
//     fontSize: 24,
//     fontWeight: "800",
//     color: "#323232",
//   },
//   newChatButton: {
//     backgroundColor: "#007AFF",
//     padding: 8,
//     borderRadius: 8,
//   },
//   newChatButtonText: {
//     color: "#FFFFFF",
//     fontWeight: "600",
//   },
//   chatList: {
//     maxHeight: 50,
//   },
//   chatItem: {
//     padding: 8,
//     marginRight: 8,
//     backgroundColor: "#E0E0E0",
//     borderRadius: 8,
//   },
//   selectedChatItem: {
//     backgroundColor: "#B0B0B0",
//   },
//   chatItemText: {
//     fontWeight: "600",
//   },
//   flatList: {
//     paddingHorizontal: 16,
//     marginBottom: 80,
//   },
//   searchBar: {
//     backgroundColor: "#ffffff",
//     width: "100%",
//     position: "absolute",
//     bottom: 0,
//     flexDirection: "row",
//     justifyContent: "center",
//     alignItems: "center",
//     paddingHorizontal: 32,
//     paddingVertical: 16,
//     gap: 8,
//   },
//   input: {
//     backgroundColor: "#fff",
//     width: "85%",
//     fontSize: 16,
//     paddingVertical: 16,
//     paddingHorizontal: 24,
//     borderRadius: 32,
//     borderWidth: 0.1,
//   },
// });

// export default Chatbot;
